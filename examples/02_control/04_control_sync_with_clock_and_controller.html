<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Waiting for the controller for non-real time simulations &mdash; XDE examples 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/josini.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="XDE examples 0.1 documentation" href="../../index.html" />
    <link rel="up" title="Control robots" href="../02_control.html" />
    <link rel="next" title="Cartesian control" href="05_cartesian_control.html" />
    <link rel="prev" title="Control a robot with a clock trigger" href="03_control_sync_with_clock.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="05_cartesian_control.html" title="Cartesian control"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="03_control_sync_with_clock.html" title="Control a robot with a clock trigger"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">XDE examples 0.1 documentation</a> &raquo;</li>
          <li><a href="../02_control.html" accesskey="U">Control robots</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="waiting-for-the-controller-for-non-real-time-simulations">
<h1>Waiting for the controller for non-real time simulations<a class="headerlink" href="#waiting-for-the-controller-for-non-real-time-simulations" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Get source of this example:</p>
<ul class="last simple">
<li><a class="reference download internal" href="../../_downloads/main9.py"><tt class="xref download docutils literal"><span class="pre">main.py</span></tt></a>.</li>
</ul>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>This example shows how to write non-real time simulations. The computation
of the physics is triggered by events, as opposed to the real time simulations
where the computation of the physics is triggered by a clock.</p>
<p class="last">It is important to note that the integration step is not affected, but the rate of integration is.
It means that if the events occur faster than the integration time, the simulation
will look accelerated. If the events occur slower than the integration time,
the simulation will appear to be in slow motion.</p>
</div>
<div class="section" id="synchronization-of-the-physic-agent">
<h2>Synchronization of the physic agent<a class="headerlink" href="#synchronization-of-the-physic-agent" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to synchronize the physics with a controller:
as soon as the command is computed, the computation of the physic is triggered.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">deploy.deployer</span> <span class="kn">as</span> <span class="nn">ddeployer</span>
<span class="n">clock</span> <span class="o">=</span> <span class="n">xdefw</span><span class="o">.</span><span class="n">rtt</span><span class="o">.</span><span class="n">Task</span><span class="p">(</span><span class="n">ddeployer</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&quot;clock&quot;</span><span class="p">,</span> <span class="s">&quot;dio::Clock&quot;</span><span class="p">,</span> <span class="s">&quot;dio-cpn-clock&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">))</span>
<span class="n">clock</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">setPeriod</span><span class="p">(</span><span class="o">.</span><span class="mo">01</span><span class="p">)</span>

<span class="c"># add Input Port in physic agent to be able to send Joint torques to a robot</span>
<span class="n">phy</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">Connectors</span><span class="o">.</span><span class="n">IConnectorRobotJointTorque</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;ict&quot;</span><span class="p">,</span> <span class="s">&quot;p1_&quot;</span><span class="p">,</span> <span class="s">&quot;p1&quot;</span><span class="p">)</span> <span class="c"># ConnectorName, PortName, RobotName</span>
                                                                    <span class="c"># It generates a port named &quot;PortName&quot;+&quot;tau&quot;</span>
<span class="c"># Create a port in the physic agent to receive ticks</span>
<span class="n">phy</span><span class="o">.</span><span class="n">addCreateInputPort</span><span class="p">(</span><span class="s">&quot;clock_trigger&quot;</span><span class="p">,</span> <span class="s">&quot;double&quot;</span><span class="p">)</span>

<span class="c"># Create a Synchronization connectors: when all events of the connector is received,</span>
<span class="c"># the updateHook, and by extension the computation of the physic, of the agent is triggered.</span>
<span class="n">icps</span> <span class="o">=</span> <span class="n">phy</span><span class="o">.</span><span class="n">s</span><span class="o">.</span><span class="n">Connectors</span><span class="o">.</span><span class="n">IConnectorSynchro</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s">&quot;icps&quot;</span><span class="p">)</span>
<span class="c"># Add event to the connector involving the reception of a new torque command.</span>
<span class="n">icps</span><span class="o">.</span><span class="n">addEvent</span><span class="p">(</span><span class="s">&quot;p1_tau&quot;</span><span class="p">)</span>
<span class="c"># Add event to the connector involving the reception of a new tick.</span>
<span class="n">icps</span><span class="o">.</span><span class="n">addEvent</span><span class="p">(</span><span class="s">&quot;clock_trigger&quot;</span><span class="p">)</span>

<span class="c"># Connection of the clock tick and controller output port to the physic agent</span>
<span class="n">clock</span><span class="o">.</span><span class="n">getPort</span><span class="p">(</span><span class="s">&quot;ticks&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">connectTo</span><span class="p">(</span><span class="n">phy</span><span class="o">.</span><span class="n">getPort</span><span class="p">(</span><span class="s">&quot;clock_trigger&quot;</span><span class="p">))</span>
<span class="n">controller</span><span class="o">.</span><span class="n">getPort</span><span class="p">(</span><span class="s">&quot;tau&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">connectTo</span><span class="p">(</span><span class="n">phy</span><span class="o">.</span><span class="n">getPort</span><span class="p">(</span><span class="s">&quot;p1_tau&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Waiting for the controller for non-real time simulations</a><ul>
<li><a class="reference internal" href="#synchronization-of-the-physic-agent">Synchronization of the physic agent</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="03_control_sync_with_clock.html"
                        title="previous chapter">Control a robot with a clock trigger</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="05_cartesian_control.html"
                        title="next chapter">Cartesian control</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/examples/02_control/04_control_sync_with_clock_and_controller.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="05_cartesian_control.html" title="Cartesian control"
             >next</a> |</li>
        <li class="right" >
          <a href="03_control_sync_with_clock.html" title="Control a robot with a clock trigger"
             >previous</a> |</li>
        <li><a href="../../index.html">XDE examples 0.1 documentation</a> &raquo;</li>
          <li><a href="../02_control.html" >Control robots</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Joseph Salini, Sovannara Hak.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>